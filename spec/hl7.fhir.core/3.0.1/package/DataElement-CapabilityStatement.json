{"resourceType":"DataElement","id":"CapabilityStatement","meta":{"lastUpdated":"2017-04-19T07:44:43.294+10:00"},"url":"http://hl7.org/fhir/DataElement/CapabilityStatement","status":"draft","experimental":true,"stringency":"fully-specified","element":[{"id":"CapabilityStatement","path":"CapabilityStatement","short":"A statement of system capabilities","definition":"A Capability Statement documents a set of capabilities (behaviors) of a FHIR Server that may be used as a statement of actual server functionality or a statement of required or desired server implementation.","min":1,"max":"1","constraint":[{"key":"dom-2","severity":"error","human":"If the resource is contained in another resource, it SHALL NOT contain nested Resources","expression":"contained.contained.empty()","xpath":"not(parent::f:contained and f:contained)","source":"DomainResource"},{"key":"dom-1","severity":"error","human":"If the resource is contained in another resource, it SHALL NOT contain any narrative","expression":"contained.text.empty()","xpath":"not(parent::f:contained and f:text)","source":"DomainResource"},{"key":"dom-4","severity":"error","human":"If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated","expression":"contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()","xpath":"not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))","source":"DomainResource"},{"key":"dom-3","severity":"error","human":"If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource","expression":"contained.where(('#'+id in %resource.descendants().reference).not()).empty()","xpath":"not(exists(for $id in f:contained/*/@id return $id[not(ancestor::f:contained/parent::*/descendant::f:reference/@value=concat('#', $id))]))","source":"DomainResource"},{"key":"cpb-8","severity":"error","human":"There can only be one REST declaration per mode.","expression":"rest.select(mode).isDistinct()","xpath":"count(f:rest)=count(distinct-values(f:rest/f:mode/@value))"},{"key":"cpb-7","severity":"error","human":"The set of documents must be unique by the combination of profile and mode.","expression":"document.select(profile.reference&mode).isDistinct()","xpath":"count(f:document[f:mode/@value='producer'])=count(distinct-values(f:document[f:mode/@value='producer']/f:profile/f:reference/@value)) and count(f:document[f:mode/@value='consumer'])=count(distinct-values(f:document[f:mode/@value='consumer']/f:profile/f:reference/@value))"},{"key":"cpb-15","severity":"error","human":"Capability Statements of kind 'instance' do not have implementation elements.","expression":"implementation.empty() or kind != 'capability'","xpath":"not(exists(f:implementation)) or (f:kind/@value != 'capability')"},{"key":"cpb-3","severity":"error","human":"Messaging end-point is required (and is only permitted) when a statement is for an implementation.","expression":"messaging.endpoint.empty() or kind = 'instance'","xpath":"not(exists(f:messaging/f:endpoint)) or f:kind/@value = 'instance'"},{"key":"cpb-14","severity":"error","human":"Capability Statements of kind 'requirements' do not have software or implementation elements.","expression":"(software.empty() and implementation.empty()) or kind != 'requirements'","xpath":"not(exists(f:software) or exists(f:implementation)) or (f:kind/@value != 'requirements')"},{"key":"cpb-2","severity":"error","human":"A Capability Statement SHALL have at least one of description, software, or implementation element.","expression":"(description.count() + software.count() + implementation.count()) > 0","xpath":"count(f:software | f:implementation | f:description) > 0"},{"key":"cpb-1","severity":"error","human":"A Capability Statement SHALL have at least one of REST, messaging or document element.","expression":"rest.exists() or messaging.exists() or document.exists()","xpath":"exists(f:rest) or exists(f:messaging) or exists(f:document)"}],"mapping":[{"identity":"rim","map":"Entity. Role, or Act"},{"identity":"rim","map":"n/a"},{"identity":"w5","map":"conformance.behavior"}]}]}